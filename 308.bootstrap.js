(self.webpackChunkgv_subway_web=self.webpackChunkgv_subway_web||[]).push([[308],{447:(e,t,l)=>{"use strict";l.d(t,{bL:()=>n,Qr:()=>o,Or:()=>c});var s=l(168);e=l.hmd(e);let i=new("undefined"==typeof TextDecoder?(0,e.require)("util").TextDecoder:TextDecoder)("utf-8",{ignoreBOM:!0,fatal:!0});i.decode();let r=null;const n=Object.freeze({Wall:0,0:"Wall",Pass:1,1:"Pass",Entrance:2,2:"Entrance",Treasury:3,3:"Treasury",Subtreasury:4,4:"Subtreasury"});class o{static __wrap(e){const t=Object.create(o.prototype);return t.ptr=e,t}__destroy_into_raw(){const e=this.ptr;return this.ptr=0,e}free(){const e=this.__destroy_into_raw();s.__wbg_subway_free(e)}constructor(){var e=s.subway_new();return o.__wrap(e)}set_field(e,t){s.subway_set_field(this.ptr,e,t)}get_field(e){return s.subway_get_field(this.ptr,e)>>>0}get_visited_probability(e){return s.subway_get_visited_probability(this.ptr,e)}init(){s.subway_init(this.ptr)}step(e){s.subway_step(this.ptr,e)}}function c(e,t){throw new Error((l=e,n=t,i.decode((null!==r&&r.buffer===s.memory.buffer||(r=new Uint8Array(s.memory.buffer)),r).subarray(l,l+n))));var l,n}},944:(e,t,l)=>{"use strict";l.r(t),l.d(t,{default:()=>o});var s=l(81),i=l.n(s),r=l(645),n=l.n(r)()(i());n.push([e.id,"\nh3 {\n        text-align: center;\n}\n#maze {\n        width: 520px;\n        display: inline-block;\n}\n#drawtool {\n        text-align: center;\n}\n#drawtool .cell {\n        cursor: pointer;\n        margin: 24px 12px;\n        border: 2px solid transparent;\n}\n#drawtool .cell.selected {\n        border: 2px solid black;\n}\n#numsteps {\n        width: 100%;\n}\n#treasury_prob {\n        float: right;\n}\n#link {\n        margin-top: 24px;\n}\n#link input {\n        width: 80%;\n        margin-left: 1em;\n}\n",""]);const o=n},370:(e,t,l)=>{"use strict";l.r(t),l.d(t,{default:()=>o});var s=l(81),i=l.n(s),r=l(645),n=l.n(r)()(i());n.push([e.id,"\n.row {\n        cursor: pointer;\n}\n",""]);const o=n},314:(e,t,l)=>{"use strict";l.r(t),l.d(t,{default:()=>o});var s=l(81),i=l.n(s),r=l(645),n=l.n(r)()(i());n.push([e.id,"\n.cell {\n        display: inline-block;\n        width: 24px;\n        height: 24px;\n        font-size: 10pt;\n        font-family: 'Courier New', Courier, monospace;\n        margin: 0;\n        border: 1px solid silver;\n        line-height: 24px;\n        text-align: center;\n\n        background-color: white;\n}\n.wall {\n        background-color: gray;\n}\n",""]);const o=n},308:(e,t,l)=>{"use strict";l.r(t);var s=l(963),i=l(252),r=l(577);const n=(0,i._)("h3",null,"–ö—É–¥–∞ —É—Ö–æ–¥—è—Ç –±—Ä–µ–≤–Ω–æ–≤–æ–∑—ã",-1),o={id:"maze"},c={id:"drawtool"},a={id:"calc"},u=(0,i._)("br",null,null,-1),p={id:"treasury_prob"},h={id:"link"},d=(0,i.Uk)("–ö–∞—Ä—Ç–∞: "),b=["value"];var f=l(447),y=l(245),m=l.n(y);const w=(0,i.aZ)({setup(){},props:{id:Number,cellType:Number,colourScheme:{type:Number,default:-1},colourValue:Number},computed:{cellClass(){return{wall:this.cellType==f.bL.Wall,pass:this.cellType==f.bL.Pass,entrance:this.cellType==f.bL.Entrance,treasury:this.cellType==f.bL.Treasury,subtreasury:this.cellType==f.bL.Subtreasury}},symbol(){return["#","¬†","üö™","üí∞","üì¶"][this.$props.cellType??1]},cellColour(){return this.$props.colourScheme<0||this.cellType==f.bL.Wall||0==this.colourValue?{}:{backgroundColor:"#"+this.colourSchemes[this.$props.colourScheme].colourAt(100*(this.colourValue??0))}}},data(){const e=new(m());return e.setSpectrum("ffc0e0","c0c0ff","3030a0"),{lastEmitted:(new Date).getTime(),colourSchemes:[e]}},emits:["touchcell"],methods:{onMove(e){let t=(new Date).getTime();e.buttons&&t-this.lastEmitted>50&&(this.$emit("touchcell",this.id),this.lastEmitted=t)}}});l(153);var _=l(744);const g=(0,_.Z)(w,[["render",function(e,t,l,n,o,c){return(0,i.wg)(),(0,i.iD)("div",{class:(0,r.C_)(["cell",e.cellClass]),style:(0,r.j5)(e.cellColour),onMousedown:t[0]||(t[0]=(0,s.iM)((e=>this.$emit("touchcell",this.id)),["prevent"])),onMousemove:t[1]||(t[1]=(...t)=>e.onMove&&e.onMove(...t)),onTouchstart:t[2]||(t[2]=(0,s.iM)((e=>this.$emit("touchcell",this.id)),["prevent"])),onTouchmove:t[3]||(t[3]=(...t)=>e.onMove&&e.onMove(...t))},(0,r.zw)(e.symbol),39)}]]),T=(0,i.aZ)({components:{mazecell:g},props:{width:Number,cells:Array},data(){return{rowWidth:this.$props.width??1,mazeCells:this.$props.cells??[]}},emits:["touchcell"],setup(){},computed:{cellRows(){let e=[];for(let t=0;t<this.mazeCells.length/this.rowWidth;t++)e.push(this.mazeCells.slice(t*this.rowWidth,(t+1)*this.rowWidth));return e}},methods:{forwardTouchCell(e){this.$emit("touchcell",e)}}});l(386);const v=(0,_.Z)(T,[["render",function(e,t,l,s,r,n){const o=(0,i.up)("mazecell");return(0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(e.cellRows,((t,l)=>((0,i.wg)(),(0,i.iD)("div",{class:"row",key:l},[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(t,((t,s)=>((0,i.wg)(),(0,i.j4)(o,{colourScheme:0,colourValue:t.prob,cellType:t.cellType,id:s+l*this.rowWidth,key:s+l*this.rowWidth,onTouchcell:e.forwardTouchCell},null,8,["colourValue","cellType","id","onTouchcell"])))),128))])))),128)}]]),x=(0,i.aZ)({components:{maze:v,mazecell:g},data(){let e={cellType:f.bL.Wall,prob:0},t=new Array(400);for(let l=0;l<400;l++)t[l]={...e};return{field:new f.Qr,cells:t,drawMode:f.bL.Pass,specials:[-1,-1,-1],numSteps:0}},computed:{getUrl(){let e="",t="AAA";for(let l=20;l<=360;l+=20){let s="";for(let e=1;e<=18;e+=6){let t=32*+(this.cells[l+e].cellType!=f.bL.Wall)+16*+(this.cells[l+e+1].cellType!=f.bL.Wall)+8*+(this.cells[l+e+2].cellType!=f.bL.Wall)+4*+(this.cells[l+e+3].cellType!=f.bL.Wall)+2*+(this.cells[l+e+4].cellType!=f.bL.Wall)+ +(this.cells[l+e+5].cellType!=f.bL.Wall);s+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".substr(t,1)}s==t?s="~":t=s,e+=s}return`f=${e}&e=${this.specials[0]}&t=${this.specials[1]}&s=${this.specials[2]}`},treasuryProb(){const e=this.specials[1];return-1==e?"0.00":this.cells[e].prob.toFixed(2)}},methods:{parseUrl(e){try{const t=e.currentTarget.value,l=new Map;t.split("&").forEach((e=>{let[t,s]=e.split("=");l.set(t,s)}));const s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_";let i="AAA",r=l.get("f")||"";for(let e=20;e<=360;e+=20){let t="";"~"==r.substr(0,1)?(t=i,r=r.substring(1)):(t=r.substr(0,3),i=t,r=r.substring(3));for(let l=1;l<=18;l+=6){let i=s.indexOf(t.substr(0,1));t=t.substring(1);for(let t=0;t<6;t++)this.field.set_field(e+l+t,i&1<<5-t?f.bL.Pass:f.bL.Wall)}}this.specials[0]=parseInt(l.get("e")||"-1"),this.specials[1]=parseInt(l.get("t")||"-1"),this.specials[2]=parseInt(l.get("s")||"-1"),this.specials[0]>=0&&this.field.set_field(this.specials[0],f.bL.Entrance),this.specials[1]>=0&&this.field.set_field(this.specials[1],f.bL.Treasury),this.specials[2]>=0&&this.field.set_field(this.specials[2],f.bL.Subtreasury);for(let e=0;e<400;e++)this.cells[e].cellType=this.field.get_field(e),this.cells[e].prob=0;this.numSteps>0&&this.recalculate(this.numSteps)}catch(e){console.log(e)}},touchCell(e){if(this.cells[e].cellType!=this.drawMode){this.specials.indexOf(e)>=0&&(this.specials[this.specials.indexOf(e)]=-1),this.field.set_field(e,this.drawMode),this.cells[e].cellType=this.field.get_field(e);const t=[f.bL.Entrance,f.bL.Treasury,f.bL.Subtreasury].indexOf(this.drawMode);if(t>=0){const l=this.specials[t];l>=0&&(this.field.set_field(l,f.bL.Pass),this.cells[l].cellType=this.field.get_field(l)),this.specials[t]=e}this.specials[0]>=0&&this.specials[1]>=0&&this.numSteps>0&&this.recalculate(this.numSteps)}},selectTool(e){this.drawMode=e},recalculate(e,t=0){t||this.field.init();for(let l=1;l<=e;l++)this.field.step(l+t);for(let e=0;e<400;e++)this.cells[e].cellType!=f.bL.Wall&&(this.cells[e].prob=this.field.get_visited_probability(e))},reset(){this.field.init();for(let e=0;e<400;e++)this.cells[e].prob=0}},watch:{numSteps(e,t){0==e?this.reset():this.specials[0]>=0&&this.specials[1]>=0&&e>0&&this.recalculate(e)}}});l(414);const L=(0,_.Z)(x,[["render",function(e,t,l,f,y,m){const w=(0,i.up)("maze"),_=(0,i.up)("mazecell");return(0,i.wg)(),(0,i.iD)(i.HY,null,[n,(0,i._)("div",o,[(0,i.Wm)(w,{width:20,cells:e.cells,onTouchcell:e.touchCell},null,8,["cells","onTouchcell"]),(0,i._)("div",c,[(0,i._)("div",null,[((0,i.wg)(),(0,i.iD)(i.HY,null,(0,i.Ko)(5,(t=>(0,i.Wm)(_,{key:t,id:1e3+t,cellType:t-1,class:(0,r.C_)({selected:t-1==e.drawMode}),onClick:l=>e.selectTool(t-1),onTouchstart:l=>e.selectTool(t-1)},null,8,["id","cellType","class","onClick","onTouchstart"]))),64))])]),(0,i._)("div",a,[(0,i.wy)((0,i._)("input",{id:"numsteps",type:"range",min:"0",max:"100","onUpdate:modelValue":t[0]||(t[0]=t=>e.numSteps=t)},null,512),[[s.nr,e.numSteps]]),u,(0,i._)("span",null,"–®–∞–≥–æ–≤: "+(0,r.zw)(e.numSteps),1),(0,i._)("span",p,(0,r.zw)(e.treasuryProb)+" üí∞",1)]),(0,i._)("div",h,[(0,i._)("label",null,[d,(0,i._)("input",{value:e.getUrl,onChange:t[1]||(t[1]=(...t)=>e.parseUrl&&e.parseUrl(...t))},null,40,b)])])])],64)}]]);(0,s.ri)(L).mount("#main")},414:(e,t,l)=>{var s=l(944);s.__esModule&&(s=s.default),"string"==typeof s&&(s=[[e.id,s,""]]),s.locals&&(e.exports=s.locals),(0,l(346).Z)("fcb77976",s,!1,{})},386:(e,t,l)=>{var s=l(370);s.__esModule&&(s=s.default),"string"==typeof s&&(s=[[e.id,s,""]]),s.locals&&(e.exports=s.locals),(0,l(346).Z)("f15b1044",s,!1,{})},153:(e,t,l)=>{var s=l(314);s.__esModule&&(s=s.default),"string"==typeof s&&(s=[[e.id,s,""]]),s.locals&&(e.exports=s.locals),(0,l(346).Z)("2c21fe42",s,!1,{})},168:(e,t,l)=>{"use strict";var s=l.w[e.id];e.exports=s,l(447),s[""]()}}]);